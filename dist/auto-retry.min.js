!function(){"use strict";var t={list:[],add:function(t){this.contains(t)||this.list.push(t)},remove:function(t){var e=this.list.indexOf(t);e>-1&&this.list.splice(e,1)},contains:function(t){return this.list.indexOf(t)>-1}},e={defaults:{retry:{max:2,interval:100,intervalMultiplicator:1},reAttempt:{max:3,interval:1e3,intervalMultiplicator:1}},override:function(t,e){var r={};return Object.keys(e).map(function(i){r[i]=t[i]||e[i]}),r},parse:function(t,e){var r;return r=t&&0!==Object.keys(t).length?this.override(t,e):e}},r={list:{resilient:{retry:{max:5,interval:100,intervalMultiplicator:1},reAttempt:{max:10,interval:1e3,intervalMultiplicator:1}},"exponential-backoff":{retry:{max:2,interval:100,intervalMultiplicator:1.5},reAttempt:{max:3,interval:1e3,intervalMultiplicator:1.5}}},get:function(t){var e;return e=void 0===this.list[t]?!1:this.list[t]},add:function(t,e){return this.get(t)?(console.error("Retry strategy",t,"already exists."),!1):void(this.list[t]=e)}},i={retryFailed:"Request failed.",reAttemptsFailed:"Re-attempts of request failed.",requestsBlocked:"Requests are currently blocked by Retry library."},o=function(){return{_options:{},_configure:function(){void 0===this._options.retry&&this.retry(),void 0===this._options.group&&this.group(this._options.request.url),this._options.retry.maxRetry=this._options.retry.max,void 0!==this._options.reAttempt&&(this._options.reAttempt.maxRetry=this._options.reAttempt.max-1)},_doRequest:function(){return axios(this._options.request)},_doRetry:function(e){var r=this;Qretry(function(){return r._doRequest()},r._options.retry).then(function(t){e.resolve(t)})["catch"](function(){PubSub.publish("retriesFailed",i.retryFailed),e.notify(i.retryFailed),r._options.reAttempt?(t.add(r._options.group),r._doReAttempt(e)):e.reject(i.retryFailed)})},_doReAttempt:function(e){var r=this;Qretry(function(){return axios(r._options.request)},r._options.reAttempt).then(function(i){t.remove(r._options.group),e.resolve(i)})["catch"](function(o){t.remove(r._options.group),PubSub.publish("reAttemptsFailed",i.reAttemptsFailed),e.reject({message:i.reAttemptsFailed,err:o})})},retry:function(t){return this._options.retry=e.parse(t,e.defaults.retry),this},request:function(t){return this._options.request=t,this},reAttempt:function(t){return this._options.reAttempt=e.parse(t,e.defaults.reAttempt),this},group:function(t){return this._options.group=t,this},run:function(){this._configure();var e=Q.defer();return t.contaians(this._options.group)?e.reject(i.requestsBlocked):this._doRetry(e),e.promise},_strategyHelper:function(t,e){console.log(t,e),e&&this[t](e)},addStrategy:function(t,e){r.add(t,e)},runStrategy:function(t){var e=r.get(t),i=this;return e?(Object.keys(e).map(function(t){i._strategyHelper(t,e[t])}),this.run()):(console.error("Retry strategy",t,"not found."),!1)}}};!function(t,e){var r=void 0!==module&&module.exports;r?module.exports=e:window[t]=e}("AjaxRetry",o)}();